?download.file
path <- 'https://www.indec.gob.ar/ftp/cuadros/economia/CNA18_C_'
cuadro <- '2_1'
extension<- '.xlsx'
paste0(path, cuadro, extension)
for (c in 1:6){
for (sc in 1:33){
cuadro <- paste(c,sc,sep='-')
print(cuadro)
}
}
for (c in 1:6){
for (sc in 1:33){
cuadro <- paste(c,sc,sep='_')
print(cuadro)
}
}
path <- 'https://www.indec.gob.ar/ftp/cuadros/economia/CNA18_C_'
extension <- '.xlsx'
for (c in 1:6){
for (sc in 1:33){
cuadro <- paste(c,sc,sep='_')
url <- paste0(path, cuadro, extension)
print(url)
}
}
tryCatch(
for (c in 1:7){
for (sc in 1:33){
cuadro <- paste(c,sc,sep='_')
url <- paste0(path, cuadro, extension)
path_to <- paste0('./tablas_cna_2018/', cuadro, extension)
print(path_to)
#download.file(url,)
}
}
)
tryCatch(
for (c in 1:7){
for (sc in 1:33){
cuadro <- paste(c,sc,sep='_')
url <- paste0(path, cuadro, extension)
path_to <- paste0('./tablas_cna_2018/C_', cuadro, extension)
download.file(url, path_to)
}
},
error=function(cond) {
message(paste("URL does not seem to exist:", url))
message("Here's the original error message:")
message(cond)
# Choose a return value in case of error
return(NA)
}
)
download.file(url, path_to)
download.file(url, path_to, method='wget')
download.file(url, path_to, method='curl')
path <- 'https://www.indec.gob.ar/ftp/cuadros/economia/CNA18_C_'
extension <- '.xlsx'
tryCatch(
for (c in 1:7){
for (sc in 1:33){
cuadro <- paste(c,sc,sep='_')
url <- paste0(path, cuadro, extension)
path_to <- paste0('./tablas_cna_2018/C_', cuadro, extension)
download.file(url, path_to, method='curl')
}
}
)
for (c in 1:7){
for (sc in 1:33){
tryCatch(
cuadro <- paste(c,sc,sep='_')
url <- paste0(path, cuadro, extension)
path_to <- paste0('./tablas_cna_2018/C_', cuadro, extension)
download.file(url, path_to, method='curl')
)
}
}
)
path <- 'https://www.indec.gob.ar/ftp/cuadros/economia/CNA18_C_'
extension <- '.xlsx'
for (c in 1:7){
for (sc in 1:33){
tryCatch(
cuadro <- paste(c,sc,sep='_')
url <- paste0(path, cuadro, extension)
path_to <- paste0('./tablas_cna_2018/C_', cuadro, extension)
download.file(url, path_to, method='curl')
)
}
}
for (c in 1:7){
for (sc in 1:33){
cuadro <- paste(c,sc,sep='_')
url <- paste0(path, cuadro, extension)
path_to <- paste0('./tablas_cna_2018/C_', cuadro, extension)
download.file(url, path_to, method='curl')
}
}
for (c in 2:7){
for (sc in 1:33){
cuadro <- paste(c,sc,sep='_')
url <- paste0(path, cuadro, extension)
path_to <- paste0('./tablas_cna_2018/C_', cuadro, extension)
download.file(url, path_to, method='curl')
}
}
path <- './CNA2018_resultados_definitivos.xls'
tab_names <- excel_sheets(path = path)
tab_prov <- tab_names[1]
library(tidyverse)
library(readxl)
path <- './CNA2018_resultados_definitivos.xls'
tab_names <- excel_sheets(path = path)
path <- './CNA2018_resultados_definitivos.xls'
tab_names <- excel_sheets(path = path)
path <- './example/CNA2018_resultados_definitivos.xls'
tab_names <- excel_sheets(path = path)
tab_prov <- tab_names[1]
tab_depto <- tab_names[5:27]
prov <- read_excel(path, sheet=tab_prov, range="B10:B33")
colnames(prov) <- "XX"
prov <- prov %>%
mutate(prov = str_replace(XX, 'del', 'de')) %>%
mutate(prov = str_match(prov, "de\\s*(.*?)\\s*\\. ")[,2]) %>%
pull()
prov[21] <- 'Santiago del Estero'
prov[22] <- 'Tierra del Fuego'
list_total <- lapply(tab_depto, function(x) read_excel(path = path, sheet = x, skip=6))
for (l in 1:length(list_total)){
list_total[[l]]$eti_prov <- prov[l]
}
total <- do.call(rbind, list_total)
colnames(total) <- c("cod_depto", "eti_depto",
"eaps_definidos", "parcelas_eaps_definidos", "superificie_eaps_definidos", "ELIMINAR1",
"eaps_mixta", "parcelas_eaps_mixta", "superificie_eaps_mixta", "eaps_mixta_terreno_sinlim", "ELIMINAR",
"eaps_no_definidos", "eti_prov")
total <- total %>%
mutate(eti_depto = case_when(
eti_prov == 'Formosa' & cod_depto == '14' ~ 'Formosa capital',
TRUE ~ eti_depto
))
deptos <- total %>%
filter(!(eti_depto %in% prov))
provs <- total %>%
filter(eti_depto %in% prov)
total[total$eti_depto %in% prov,]
colnames(provs) <- c("cod_prov", "eti_prov",
"eaps_definidos", "parcelas_eaps_definidos", "superificie_eaps_definidos", "ELIMINAR1",
"eaps_mixta", "parcelas_eaps_mixta", "superificie_eaps_mixta", "eaps_mixta_terreno_sinlim", "ELIMINAR",
"eaps_no_definidos", "ELIMINAR3")
tab_prov
tab_depto
prov <- read_excel(path, sheet=tab_prov, range="B10:B33")
prov
